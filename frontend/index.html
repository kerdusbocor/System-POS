<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Universal POS System</title>
  <meta name="description" content="Universal Point of Sale System">

  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#6366f1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="POS">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="msapplication-TileColor" content="#6366f1">
  <meta name="msapplication-tap-highlight" content="no">

  <!-- Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180.png">

  <link rel="stylesheet" href="css/styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
  <div id="app">
    <!-- Login Screen -->
    <div id="login-screen" class="screen active">
      <div class="login-container">
        <div class="login-logo">
          <div class="logo-icon">POS</div>
          <h1>Universal POS</h1>
          <p>Point of Sale System</p>
        </div>
        <form id="login-form" class="login-form">
          <div class="form-group">
            <label for="login-email">Email</label>
            <input type="email" id="login-email" placeholder="Enter your email" required>
          </div>
          <div class="form-group">
            <label for="login-password">Password</label>
            <input type="password" id="login-password" placeholder="Enter your password" required>
          </div>
          <button type="submit" class="btn btn-primary btn-block">
            <span>Sign In</span>
          </button>
          <div class="login-divider"><span>or</span></div>
          <button type="button" id="pin-login-btn" class="btn btn-secondary btn-block">
            <span>Quick PIN Login</span>
          </button>
        </form>
        <div id="pin-login-form" class="pin-form hidden">
          <h3>Enter PIN</h3>
          <div class="pin-input-container">
            <input type="password" id="pin-input" maxlength="6" pattern="[0-9]*" inputmode="numeric">
          </div>
          <div class="pin-keypad">
            <button class="pin-key" data-key="1">1</button>
            <button class="pin-key" data-key="2">2</button>
            <button class="pin-key" data-key="3">3</button>
            <button class="pin-key" data-key="4">4</button>
            <button class="pin-key" data-key="5">5</button>
            <button class="pin-key" data-key="6">6</button>
            <button class="pin-key" data-key="7">7</button>
            <button class="pin-key" data-key="8">8</button>
            <button class="pin-key" data-key="9">9</button>
            <button class="pin-key pin-key-clear" data-key="clear">C</button>
            <button class="pin-key" data-key="0">0</button>
            <button class="pin-key pin-key-enter" data-key="enter">â†µ</button>
          </div>
          <button type="button" id="back-to-login" class="btn btn-link">Back to Email Login</button>
        </div>
      </div>
    </div>

    <!-- Main App -->
    <div id="main-app" class="hidden">
      <!-- Sidebar -->
      <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
          <div class="logo-small">POS</div>
          <span class="brand-name">Universal POS</span>
        </div>
        <nav class="sidebar-nav">
          <a href="#" class="nav-item active" data-screen="pos">
            <svg class="nav-icon" viewBox="0 0 24 24">
              <path
                d="M17 2H7c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 18H7V4h10v16zM8 5h8v2H8zm0 3h8v2H8zm0 3h5v2H8z" />
            </svg>
            <span>POS</span>
          </a>
          <a href="#" class="nav-item" data-screen="products">
            <svg class="nav-icon" viewBox="0 0 24 24">
              <path
                d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z" />
            </svg>
            <span>Products</span>
          </a>
          <a href="#" class="nav-item" data-screen="customers">
            <svg class="nav-icon" viewBox="0 0 24 24">
              <path
                d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" />
            </svg>
            <span>Customers</span>
          </a>
          <a href="#" class="nav-item" data-screen="workorders">
            <svg class="nav-icon" viewBox="0 0 24 24">
              <path
                d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z" />
            </svg>
            <span>Work Orders</span>
          </a>
          <a href="#" class="nav-item" data-screen="reports">
            <svg class="nav-icon" viewBox="0 0 24 24">
              <path
                d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z" />
            </svg>
            <span>Reports</span>
          </a>
        </nav>
        <div class="sidebar-footer">
          <div class="user-info">
            <div class="user-avatar" id="user-avatar">U</div>
            <div class="user-details">
              <span class="user-name" id="user-name">User</span>
              <span class="user-role" id="user-role">Cashier</span>
            </div>
          </div>
          <button id="logout-btn" class="btn-logout" title="Logout">
            <svg viewBox="0 0 24 24">
              <path
                d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z" />
            </svg>
          </button>
        </div>
      </aside>

      <!-- Main Content -->
      <main id="main-content" class="main-content">
        <!-- POS Screen -->
        <section id="pos-screen" class="content-screen active">
          <div class="pos-layout">
            <!-- Product Grid -->
            <div class="pos-products">
              <div class="pos-header">
                <div class="search-box">
                  <svg class="search-icon" viewBox="0 0 24 24">
                    <path
                      d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                  </svg>
                  <input type="text" id="product-search" placeholder="Search or scan barcode..." autofocus>
                </div>
                <div class="category-tabs" id="category-tabs">
                  <button class="category-tab active" data-category="all">All</button>
                </div>
              </div>
              <div class="product-grid" id="product-grid">
                <!-- Products loaded dynamically -->
              </div>
            </div>

            <!-- Cart -->
            <div class="pos-cart">
              <div class="cart-header">
                <h2>Current Sale</h2>
                <div class="cart-actions">
                  <button id="hold-btn" class="btn btn-sm btn-secondary" title="Hold">Hold</button>
                  <button id="clear-cart-btn" class="btn btn-sm btn-danger" title="Clear">Clear</button>
                </div>
              </div>
              <div class="cart-customer">
                <button id="select-customer-btn" class="customer-select-btn">
                  <svg viewBox="0 0 24 24">
                    <path
                      d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                  </svg>
                  <span id="selected-customer-name">Walk-in Customer</span>
                </button>
              </div>
              <div class="cart-items" id="cart-items">
                <div class="cart-empty">
                  <svg viewBox="0 0 24 24">
                    <path
                      d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z" />
                  </svg>
                  <p>Cart is empty</p>
                </div>
              </div>
              <div class="cart-summary">
                <div class="summary-row">
                  <span>Subtotal</span>
                  <span id="cart-subtotal">Rp 0</span>
                </div>
                <div class="summary-row discount-row hidden" id="discount-row">
                  <span>Discount</span>
                  <span id="cart-discount">- Rp 0</span>
                </div>
                <div class="summary-row">
                  <span>Tax</span>
                  <span id="cart-tax">Rp 0</span>
                </div>
                <div class="summary-row total-row">
                  <span>Total</span>
                  <span id="cart-total">Rp 0</span>
                </div>
              </div>
              <div class="cart-buttons">
                <button id="discount-btn" class="btn btn-secondary">Discount</button>
                <button id="pay-btn" class="btn btn-primary btn-large">Pay</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Products Screen -->
        <section id="products-screen" class="content-screen">
          <div class="screen-header">
            <h1>Products & Services</h1>
            <button id="add-product-btn" class="btn btn-primary">+ Add Product</button>
          </div>
          <div class="screen-toolbar">
            <div class="search-box">
              <svg class="search-icon" viewBox="0 0 24 24">
                <path
                  d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
              </svg>
              <input type="text" id="products-search" placeholder="Search products...">
            </div>
            <select id="products-filter" class="select-input">
              <option value="all">All Types</option>
              <option value="product">Products</option>
              <option value="service">Services</option>
              <option value="bundle">Bundles</option>
            </select>
          </div>
          <div class="data-table-container">
            <table class="data-table" id="products-table">
              <thead>
                <tr>
                  <th>SKU</th>
                  <th>Name</th>
                  <th>Type</th>
                  <th>Category</th>
                  <th>Price</th>
                  <th>Stock</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="products-tbody"></tbody>
            </table>
          </div>
        </section>

        <!-- Customers Screen -->
        <section id="customers-screen" class="content-screen">
          <div class="screen-header">
            <h1>Customers</h1>
            <button id="add-customer-btn" class="btn btn-primary">+ Add Customer</button>
          </div>
          <div class="screen-toolbar">
            <div class="search-box">
              <svg class="search-icon" viewBox="0 0 24 24">
                <path
                  d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
              </svg>
              <input type="text" id="customers-search" placeholder="Search customers...">
            </div>
          </div>
          <div class="data-table-container">
            <table class="data-table" id="customers-table">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Phone</th>
                  <th>Email</th>
                  <th>Total Orders</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="customers-tbody"></tbody>
            </table>
          </div>
        </section>

        <!-- Work Orders Screen -->
        <section id="workorders-screen" class="content-screen">
          <div class="screen-header">
            <h1>Work Orders</h1>
            <button id="add-workorder-btn" class="btn btn-primary">+ New Work Order</button>
          </div>
          <div class="screen-toolbar">
            <div class="search-box">
              <svg class="search-icon" viewBox="0 0 24 24">
                <path
                  d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
              </svg>
              <input type="text" id="workorders-search" placeholder="Search work orders...">
            </div>
            <select id="workorders-filter" class="select-input">
              <option value="all">All Status</option>
              <option value="pending">Pending</option>
              <option value="in_progress">In Progress</option>
              <option value="waiting_parts">Waiting Parts</option>
              <option value="completed">Completed</option>
              <option value="delivered">Delivered</option>
            </select>
          </div>
          <div class="workorder-cards" id="workorder-cards">
            <!-- Work orders loaded dynamically -->
          </div>
        </section>

        <!-- Reports Screen -->
        <section id="reports-screen" class="content-screen">
          <div class="screen-header">
            <h1>Reports</h1>
          </div>
          <div class="reports-filters">
            <div class="date-range">
              <input type="date" id="report-start-date">
              <span>to</span>
              <input type="date" id="report-end-date">
              <button id="apply-report-filter" class="btn btn-primary">Apply</button>
            </div>
          </div>
          <div class="reports-grid">
            <div class="report-card">
              <h3>Sales Summary</h3>
              <div class="report-value" id="report-total-sales">Rp 0</div>
              <div class="report-label">Total Sales</div>
              <div class="report-stats">
                <div class="stat">
                  <span class="stat-value" id="report-tx-count">0</span>
                  <span class="stat-label">Transactions</span>
                </div>
                <div class="stat">
                  <span class="stat-value" id="report-avg-sale">Rp 0</span>
                  <span class="stat-label">Avg Sale</span>
                </div>
              </div>
            </div>
            <div class="report-card">
              <h3>Work Orders</h3>
              <div class="report-value" id="report-wo-revenue">Rp 0</div>
              <div class="report-label">Revenue</div>
              <div class="report-stats">
                <div class="stat">
                  <span class="stat-value" id="report-wo-count">0</span>
                  <span class="stat-label">Total Orders</span>
                </div>
                <div class="stat">
                  <span class="stat-value" id="report-wo-completed">0</span>
                  <span class="stat-label">Completed</span>
                </div>
              </div>
            </div>
            <div class="report-card wide">
              <h3>Top Products</h3>
              <div class="top-products-list" id="top-products-list">
                <!-- Loaded dynamically -->
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <!-- Modals -->
    <div id="modal-overlay" class="modal-overlay hidden">
      <div id="modal-container" class="modal-container">
        <!-- Modal content injected dynamically -->
      </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>
  </div>

  <script src="js/api.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/pos.js"></script>
  <script src="js/products.js"></script>
  <script src="js/customers.js"></script>
  <script src="js/workorders.js"></script>
  <script src="js/reports.js"></script>
  <script src="js/pwa.js"></script>
  <script src="js/app.js"></script>
</body>

</html>